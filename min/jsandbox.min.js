//@source http://github.com/eligrey/jsandbox/blob/master/src/jsandbox.js
"use strict";(function(){if(typeof this.Worker==="undefined"){return}if(typeof JSON==="undefined"){(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(document.createElement("script")).src="http://github.com/eligrey/jsandbox/raw/master/min/json2.js"}var k=this,n="eval",b="exec",p="load",m="requests",o="input",l="terminate",d="data",j="callback",a="onerror",r="worker",h=function(){var i=this;if(!(i instanceof h)){return new h()}i[r]=new k.Worker(h.url);i[m]={};i[r].onmessage=function(t){var u=t[d],s;if(typeof u==="string"){try{u=JSON.parse(u)}catch(v){return}}if(typeof u!=="object"){return}s=i[m][u.id];if(s){if(u.error){if(typeof i[a]==="function"){i[a](u)}if(typeof s[a]==="function"){s[a].call(i,u.error)}}else{if(typeof i.onresponse==="function"){i.onresponse(u)}if(typeof s[j]==="function"){s[j].call(i,u.results)}}delete i[m][u.id]}}},f=h.prototype,q=function(i){f[i]=function(u,x,t,s){if(typeof u==="string"||Object.prototype.toString.call(u)==="[object Array]"||arguments.length>1){u={data:u,input:t,callback:x,onerror:s}}if(i===p&&typeof u[d]==="string"){u[d]=[u[d]]}var v=u[d],w=this.createRequestID();t=u[o];delete u[d];delete u[o];this[m][w]=u;this[r].postMessage({id:w,method:i,data:v,input:t,toString:function(){return JSON.stringify(this)}});return w};h[i]=function(){var s=new h();s.onresponse=s[a]=function(){s[l]();s=null};f[i].apply(s,Array.prototype.slice.call(arguments));return h}},g,c=[n,p,b],e=c.length;while(e--){q(c[e])}f[l]=function(){this[m]={};this[r][l]()};f.abort=function(i){delete this[m][i]};f.createRequestID=function(){var i=Math.random().toString();if(i in this[m]){return this.createRequestID()}return i};(document.querySelector&&(g=document.querySelector('link[rel="Sandbox"][href]'))&&(h.url=g.getAttribute("href")));k.Sandbox=h}.call(this));
